<!DOCTYPE html>
<html>
<head>
    <title>ë‚´ ìŠ¤ì¼€ì¤„ (ìº˜ë¦°ë”)</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        
        /* ìº˜ë¦°ë” ê·¸ë¦¬ë“œ ìŠ¤íƒ€ì¼ */
        .calendar-container {
            display: grid;
            grid-template-columns: repeat(7, 1fr); /* 7ì¹¸ìœ¼ë¡œ ë‚˜ëˆ„ê¸° (ì›”~ì¼) */
            gap: 5px;
            max-width: 1000px;
        }
        
        .day-header {
            background-color: #333;
            color: white;
            padding: 10px;
            text-align: center;
            font-weight: bold;
        }
        
        .day-cell {
            border: 1px solid #ddd;
            min-height: 120px; /* ì¹¸ ë†’ì´ */
            padding: 5px;
            background-color: #fff;
            vertical-align: top;
        }
        
        .day-number {
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
        }
        
        .empty-cell {
            background-color: #f9f9f9; /* ë‚ ì§œ ì—†ëŠ” ì¹¸ì€ íšŒìƒ‰ */
        }

        /* ìŠ¤ì¼€ì¤„ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .schedule-item {
            background-color: #e3f2fd;
            border: 1px solid #90caf9;
            border-radius: 4px;
            padding: 4px;
            margin-bottom: 4px;
            font-size: 0.85em;
        }
        .store-name { font-weight: bold; color: #1565c0; }
        .work-time { color: #555; }
    </style>
</head>
<body>
    {% with messages = get_flashed_messages() %}
     <!--   {% if messages %}
            <script>
            // íŒŒì´ì¬ì—ì„œ ë³´ë‚¸ ë©”ì‹œì§€ê°€ ìˆìœ¼ë©´ ìë°”ìŠ¤í¬ë¦½íŠ¸ ê²½ê³ ì°½(alert)ìœ¼ë¡œ ë„ì›ë‹ˆë‹¤.
            {% for message in messages %}
                alert("{{ message }}"); 
            {% endfor %}
            </script>
        {% endif %}
    {% endwith %} -->
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div style="background-color: #f8d7da; color: #721c24; padding: 10px; margin-bottom: 10px; border: 1px solid #f5c6cb; border-radius: 4px;">
            {% for message in messages %}
                <strong>ì•Œë¦¼:</strong> {{ message }}
            {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    <div style="display: flex; justify-content: space-between; align-items: center; max-width: 1000px; margin-bottom: 10px;">
    <a href="{{ url_for('dashboard', year=prev_year, month=prev_month) }}" 
       style="text-decoration: none; font-size: 2em; color: #333;">
       &lt; 
    </a>

    <h1 style="margin: 0;">ğŸ“… {{ year }}ë…„ {{ month }}ì›”</h1>

    <a href="{{ url_for('dashboard', year=next_year, month=next_month) }}" 
       style="text-decoration: none; font-size: 2em; color: #333;">
       &gt;
    </a>
    </div>
    <p>ì•ˆë…•í•˜ì„¸ìš”, <b>{{ name }}</b>ë‹˜! ì´ë²ˆ ë‹¬ ì¼ì •ì„ í™•ì¸í•˜ì„¸ìš”.</p>
    
    <div class="calendar-container">
        <div class="day-header">ì›”</div>
        <div class="day-header">í™”</div>
        <div class="day-header">ìˆ˜</div>
        <div class="day-header">ëª©</div>
        <div class="day-header">ê¸ˆ</div>
        <div class="day-header">í† </div>
        <div class="day-header" style="color: #ff8a80;">ì¼</div>

        {% for week in calendar_matrix %}
            {% for day in week %}
                {% if day == 0 %}
                    <div class="day-cell empty-cell"></div>
                {% else %}
                    <div class="day-cell">
                        <span class="day-number">{{ day }}</span>
                        
                        {% for schedule in schedule_map[day] %}
    
                            {% if schedule.type == 'pending' %}
                                <div class="schedule-item" style="background-color: #fff3e0; border-color: #ffb74d; opacity: 0.7; border-style: dashed">
                                    <div class="store-name" style="color: #ff9800;">(ìŠ¹ì¸ ëŒ€ê¸°) {{ schedule.store_name }}</div>
                                    <div class="work-time">{{ schedule.time_str }}</div>
                                    
                                    <form action="{{ url_for('cancel_accept', deta_id=schedule.deta_id) }}" method="post" style="margin-top: 5px;">
                                        <button type="submit" 
                                                style="background-color: #ef5350; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8em; width: 100%;"
                                                onclick="return confirm('ëŒ€íƒ€ ìˆ˜ë½ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                                            â†©ï¸ ìˆ˜ë½ ì·¨ì†Œ
                                        </button>
                                    </form>
                                </div>

                            {% else %}
                                <div class="schedule-item">
                                    <div class="store-name">{{ schedule.store_name }}</div>
                                    <div class="work-time">{{ schedule.time_str }}</div>
                                    
                                    <div style="margin-top: 5px;">
                                        {% if schedule.status == 'ì—†ìŒ' %}
                                            <form action="{{ url_for('request_deta', schedule_id=schedule.id) }}" method="post">
                                                <button type="submit" style="background-color: #ff5252; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8em; width: 100%;" onclick="return confirm('ì´ ìŠ¤ì¼€ì¤„ì˜ ëŒ€íƒ€ë¥¼ êµ¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                                                    ğŸ“¢ ëŒ€íƒ€ êµ¬í•¨
                                                </button>
                                            </form>
                                        {% elif schedule.status == 'êµ¬í•˜ëŠ”ì¤‘' %}
                                            <span style="font-size: 0.8em; color: #2196F3; font-weight: bold;">â³ êµ¬í•˜ëŠ” ì¤‘...</span>
                                            <form action="{{ url_for('cancel_deta', schedule_id=schedule.id) }}" method="post" style="margin-top: 3px;">
                                                <button type="submit" style="background-color: #90a4ae; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8em; width: 100%;" onclick="return confirm('ëŒ€íƒ€ ìš”ì²­ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                                                    âŒ ìš”ì²­ ì·¨ì†Œ
                                                </button>
                                            </form>
                                        {% elif schedule.status == 'ìŠ¹ì¸ëŒ€ê¸°' %}
                                            <span style="font-size: 0.8em; color: #ff9800; font-weight: bold;">ğŸ”’ ìŠ¹ì¸ ëŒ€ê¸°</span>
                                        {% else %}
                                            <span style="font-size: 0.8em; color: #4caf50;">{{ schedule.status }}</span>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endif %}

                        {% endfor %}
                                                
                    </div>
                {% endif %}
            {% endfor %}
        {% endfor %}
    </div> <div style="max-width: 1000px; margin-top: 40px; border-top: 2px dashed #ccc; padding-top: 20px;">
        <h2>ğŸ“¢ ë™ë£Œë“¤ì˜ ëŒ€íƒ€ ìš”ì²­! </h2>
        
        {% if open_requests %}
            <table style="width: 100%; border-collapse: collapse;">
                <tr style="background-color: #ffebee;">
                    <th>ë§¤ì¥</th>
                    <th>ìš”ì²­ì</th>
                    <th>ê·¼ë¬´ ë‚ ì§œ</th>
                    <th>ì‹œê°„</th>
                    <th>ëŒ€íƒ€ ìˆ˜ë½</th>
                </tr>
                {% for req in open_requests %}
                <tr>
                    <td>{{ req[2] }}</td> <td>{{ req[3] }}</td> <td>{{ req[4].strftime('%Y-%m-%d') }}</td>
                    <td>{{ req[4].strftime('%H:%M') }} ~ {{ req[5].strftime('%H:%M') }}</td>
                    <td>
                        <form action="{{ url_for('accept_deta', deta_id=req[0], schedule_id=req[1]) }}" method="post">
                            <button type="submit" 
                                    style="background-color: #4caf50; color: white; padding: 5px 10px; border: none; borderRadius: 4px; cursor: pointer;"
                                    onclick="return confirm('ì •ë§ ê·¼ë¬´ë¥¼ ëŒ€ì‹  í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                                ğŸ™†â€â™‚ï¸ ì œê°€ í• ê²Œìš”!
                            </button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </table>
        {% else %}
            <p style="color: #666; text-align: center;">í˜„ì¬ ì˜¬ë¼ì˜¨ ëŒ€íƒ€ ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤. í‰í™”ë¡­ë„¤ìš”! ğŸ•Šï¸</p>
        {% endif %}
    </div>

</body>
</html>

    <br>
    <a href="/">ë¡œê·¸ì•„ì›ƒ</a>
</body>
</html>